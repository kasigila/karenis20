<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>APT Invite Request | BYZ</title>

  <style>
  :root{
    --bg:#ffffff;
    --bg-alt:#f5f5f7;
    --bg-elev:#ffffff;
    --text:#1d1d1f;
    --sub:#6e6e73;
    --border:#d2d2d7;
    --accent:#000000;

    --radius: 22px;
    --radius-lg: 28px;
    --shadow: 0 18px 60px rgba(0,0,0,.08);
    --shadow-soft: 0 10px 30px rgba(0,0,0,.08);
    --ease: cubic-bezier(.2,.8,.2,1);
    --max: 980px;
    --header-h: 64px;
  }

  [data-theme="dark"]{
    --bg:#000000;
    --bg-alt:#1c1c1e;
    --bg-elev:#0b0b0c;
    --text:#f5f5f7;
    --sub:#a1a1a6;
    --border:#2c2c2e;
    --accent:#ffffff;
    --shadow: 0 18px 60px rgba(0,0,0,.35);
    --shadow-soft: 0 10px 30px rgba(0,0,0,.35);
  }

  *{box-sizing:border-box;margin:0;padding:0}
  html{scroll-behavior:smooth}
  body{
    font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Helvetica Neue",Helvetica,Arial,sans-serif;
    background:var(--bg);
    color:var(--text);
    line-height:1.55;
    transition: background .35s var(--ease), color .35s var(--ease);
    overflow-x:hidden;
  }

  body::before,
  body::after{
    content:"";
    position:fixed;
    inset:auto;
    width:520px;
    height:520px;
    border-radius:50%;
    filter: blur(80px);
    opacity:.25;
    pointer-events:none;
    z-index:-1;
  }
  body::before{
    background: radial-gradient(circle, rgba(0,0,0,.12), transparent 60%);
    top:-120px; right:-160px;
  }
  body::after{
    background: radial-gradient(circle, rgba(0,0,0,.08), transparent 60%);
    bottom:-180px; left:-160px;
  }
  [data-theme="dark"] body::before{
    background: radial-gradient(circle, rgba(255,255,255,.08), transparent 60%);
  }
  [data-theme="dark"] body::after{
    background: radial-gradient(circle, rgba(255,255,255,.06), transparent 60%);
  }

  a{color:inherit;text-decoration:none}
    
 .container{max-width:var(--max);margin:0 auto;padding:0 24px}
@media (max-width: 560px){
  .container{ padding: 0 24px; }
}

  header{
    position:fixed;top:0;left:0;right:0;
    height:var(--header-h);
    background: color-mix(in srgb, var(--bg) 86%, transparent);
    backdrop-filter: blur(18px);
    border-bottom:1px solid var(--border);
    z-index:999;
  }
  .header-inner{
    height:var(--header-h);
    display:flex;align-items:center;justify-content:space-between;
  }
  .brand{
    display:flex;align-items:center;gap:10px;
    font-weight:700;letter-spacing:-.4px;
  }
  .brand-logo-wrap{
    width:52px;height:52px;border-radius:14px;
    overflow:hidden;display:grid;place-items:center;
  }
  .brand-logo{width:100%;height:100%;object-fit:contain;display:block}
  .logo-dark{display:none;}
  [data-theme="dark"] .logo-light{display:none;}
  [data-theme="dark"] .logo-dark{display:block;}

  .header-actions{
    display:flex;
    align-items:center;
    gap:10px;
  }

  .btn{
    display:inline-flex;align-items:center;justify-content:center;
    gap:10px;padding:12px 18px;border-radius:999px;
    border:1px solid var(--border);
    background:var(--bg-elev);
    font-size:14px;font-weight:600;
    cursor:pointer;
    transition: transform .25s var(--ease), box-shadow .25s var(--ease);
  }
  .btn:hover{transform: translateY(-2px); box-shadow: var(--shadow-soft)}
  .btn.primary{background:var(--accent);color:var(--bg);border-color:transparent}
  .btn.ghost{background:transparent}

  .theme-btn{
    width:44px;
    height:44px;
    border-radius:999px;
    border:1px solid var(--border);
    background: var(--bg-elev);
    display:inline-flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    transition: transform .2s var(--ease), box-shadow .2s var(--ease), background .2s var(--ease);
    box-shadow: var(--shadow-soft);
    color: var(--text);
  }
  .theme-btn:hover{
    transform: translateY(-1px);
    box-shadow: var(--shadow);
  }
  .theme-glyph{
    width:20px;
    height:20px;
    display:block;
  }

  main{padding-top:calc(var(--header-h) + 22px)}

  .hero{
    padding: 24px 0 16px;
  }
  .hero-card{
    border-radius: var(--radius-lg);
    border:1px solid var(--border);
    background:
      radial-gradient(800px 300px at 20% 0%, color-mix(in srgb, var(--bg-alt) 70%, transparent), transparent 70%),
      color-mix(in srgb, var(--bg-elev) 95%, transparent);
    box-shadow: var(--shadow);
    padding: 22px;
  }
    
  .hero-title{
  font-size: clamp(2.1rem, 5vw, 3.2rem);
  letter-spacing:-1px;
  font-weight:900; /* matches Request Form title weight */
}

  .hero-sub{
    margin-top:8px;color:var(--sub);max-width:60ch;
  }
  .hero-row{
    margin-top:14px;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
  }
  .hero-pill{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:8px 12px;
    border-radius:999px;
    border:1px solid var(--border);
    background: color-mix(in srgb, var(--bg-alt) 70%, transparent);
    font-size:12px;
    font-weight:700;
    color:var(--sub);
    box-shadow: var(--shadow-soft);
  }

  .layout{
    display:grid;
    grid-template-columns: 1fr;
    gap:16px;
    margin-top:16px;
  }

  .form-card{
    border-radius: var(--radius-lg);
    border:1px solid var(--border);
    background: var(--bg-elev);
    box-shadow: var(--shadow);
    padding: 18px;
  }
  .form-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    flex-wrap:wrap;
    margin-bottom:12px;
  }
  .form-title{
    font-weight:900;
    letter-spacing:-.4px;
    font-size:18px;
  }
  .form-sub{
    color:var(--sub);
    font-size:13px;
  }

  .divider{
    height:1px;
    background: var(--border);
    opacity:.6;
    margin:12px 0;
  }

  .form-grid{
    display:grid;
    grid-template-columns: repeat(2, 1fr);
    gap:12px;
  }
  @media (max-width: 720px){
    .form-grid{ grid-template-columns: 1fr; }
  }

  .field{
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  label{font-size:13px;color:var(--sub)}
  input, select, textarea{
    width:100%;
    padding:14px;
    border-radius:18px;
    border:1px solid var(--border);
    background: var(--bg-elev);
    color: var(--text);
    font-size:14px;
    outline:none;
    box-shadow: var(--shadow-soft);
  }
  textarea{min-height:120px;resize:vertical}

  .form-actions{
    display:flex;
    gap:10px;
    align-items:center;
    flex-wrap:wrap;
    margin-top:14px;
  }
    .apt-success{
  border-radius: var(--radius-lg);
  border:1px solid var(--border);
  background: var(--bg-elev);
  box-shadow: var(--shadow);
  padding: 18px;
  margin-top: 12px;
}
.apt-success .big{
  font-size: 20px;
  font-weight: 900;
  letter-spacing: -.4px;
}
.apt-success .sub{
  margin-top: 8px;
  color: var(--sub);
  font-size: 13px;
}

    .note{
    font-size:12px;
    color:var(--sub);
  }

  .hidden{display:none !important;}

  .apt-modal-backdrop{
    position:fixed;
    inset:0;
    z-index:4000;
    background: rgba(0,0,0,.45);
    backdrop-filter: blur(12px);
    display:grid;
    place-items:center;
    padding: 20px;
  }
  .apt-modal{
    width: min(520px, 100%);
    border-radius: 26px;
    border:1px solid var(--border);
    background: color-mix(in srgb, var(--bg) 92%, transparent);
    box-shadow: var(--shadow);
    overflow:hidden;
  }
  .apt-modal-head{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:12px;
    padding:16px 16px 0 16px;
  }
  .apt-modal-title{
    font-weight:900;
    letter-spacing:-.6px;
    font-size:18px;
  }
  .apt-modal-sub{
    margin-top:4px;
    font-size:13px;
    color:var(--sub);
  }
  .apt-modal-x{
    width:42px;height:42px;
    border-radius:16px;
    border:1px solid var(--border);
    background: color-mix(in srgb, var(--bg) 88%, transparent);
    box-shadow: var(--shadow-soft);
    cursor:pointer;
  }
  .apt-modal-body{
    padding:16px;
  }
  .apt-modal-row{
    margin-top:10px;
    border-radius:18px;
    border:1px solid var(--border);
    background: var(--bg-elev);
    box-shadow: var(--shadow-soft);
    padding:12px 14px;
  }
  .apt-modal-row .k{ color:var(--sub); font-size:12px; }
  .apt-modal-row .v{ margin-top:4px; font-weight:900; }

  .btn.submitted{
    background:#0a7f3f;
    color:#fff;
    border-color: transparent;
  }

  </style>
</head>

<body>
<header>
  <div class="container header-inner">
    <a class="brand" href="index.html" aria-label="BYZ Home">
      <span class="brand-logo-wrap" aria-hidden="true">
        <img class="brand-logo logo-light" src="assets/byz-logo-black.png" alt="" />
        <img class="brand-logo logo-dark"  src="assets/byz-logo-white.png" alt="" />
      </span>
    </a>

    <div class="header-actions">
      <button class="theme-btn" id="themeToggle" type="button" aria-label="Toggle theme" aria-pressed="false" title="Switch to dark mode">
        <svg viewBox="0 0 24 24" aria-hidden="true" class="theme-glyph">
          <circle cx="12" cy="12" r="8.5" fill="none" stroke="currentColor" stroke-width="2" />
          <circle cx="12" cy="12" r="6" fill="currentColor" />
          <defs>
            <clipPath id="themeHalfClip">
              <circle cx="12" cy="12" r="6" />
            </clipPath>
          </defs>
          <g clip-path="url(#themeHalfClip)">
            <rect x="12" y="6" width="6" height="12" style="fill: var(--bg-elev);" />
          </g>
        </svg>
      </button>

      <a class="btn ghost" href="index.html"><i class="fa-solid fa-arrow-left"></i> Back</a>
    </div>
  </div>
</header>

<main>
  <section class="hero">
  <div class="container">
    <div class="hero-card">
      <div class="hero-title">APT Session Invite Request</div>
      <p class="hero-sub">Private, invite‑only. Submit your details and we’ll confirm availability with you directly.</p>

      <div class="hero-row">
        <span class="hero-pill"><i class="fa-solid fa-lock"></i> Invite‑Only Access</span>
        <span class="hero-pill"><i class="fa-solid fa-location-dot"></i> Dar es Salaam</span>
        <span class="hero-pill"><i class="fa-brands fa-whatsapp"></i> WhatsApp Reply</span>
      </div>
    </div>
  </section>

  <section class="layout">
  <div class="container">
    <div class="form-card">
      <div class="form-head">
        <div>
          <div class="form-title">Request Form</div>
          
        </div>
        <span class="hero-pill"><i class="fa-solid fa-shield-halved"></i> Secure</span>
      </div>

      <div class="divider"></div>

      <form id="aptForm">
        <div class="form-grid">
          <div class="field">
            <label for="aptName">Full Name</label>
            <input id="aptName" required />
          </div>
          <div class="field">
            <label for="aptPhone">WhatsApp Number</label>
            <input id="aptPhone" required />
          </div>
          <div class="field">
            <label for="aptIg">Instagram Handle</label>
            <input id="aptIg" placeholder="@handle" />
          </div>
          
          <div class="field">
  <label for="aptBefore">Have you been to APT before?</label>
  <select id="aptBefore" required>
    <option value="" selected disabled>Select</option>
    <option>Yes</option>
    <option>No</option>
  </select>
</div>

          
          <div class="field">
            <label for="aptNotes">Notes</label>
            <textarea id="aptNotes" placeholder="Any preferences or special requests"></textarea>
          </div>
        </div>

        <div class="form-actions">
          
          <button id="aptSubmitBtn" class="btn primary" type="submit">
  <i class="fa-solid fa-paper-plane"></i> Request Invite
</button>

          
          <span class="note">Submitting opens WhatsApp with your details.</span>
        </div>
      </form>
      
    

    </div>
  </section>
</main>

<script>
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxl8qg5fxw8yWZJj-R98x0V0nBALjQv66xuJLiom5rkEh_BpYtZRrMcFlYkjxAOq6UC/exec";

(function(){
  const form = document.getElementById("aptForm");
    let __submittingApt = false;

  if(!form) return;

  const WHATSAPP = "255768464367";

  form.addEventListener("submit", async (e) => {
  e.preventDefault();
  if(__submittingApt) return;
  __submittingApt = true;

  const submitBtn = document.getElementById("aptSubmitBtn");
  if(submitBtn){
    submitBtn.disabled = true;
    submitBtn.style.opacity = "0.7";
    submitBtn.style.pointerEvents = "none";
    submitBtn.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i> Sending...`;
  }

  const name = document.getElementById("aptName").value.trim();
  const phone = document.getElementById("aptPhone").value.trim();
  let ig = document.getElementById("aptIg").value.trim();
  if (ig && !ig.startsWith("@")) ig = "@" + ig;

  const before = document.getElementById("aptBefore").value;
  const notes = document.getElementById("aptNotes").value.trim();

  const data = {
    name,
    phone,
    instagram: ig,
    beenBefore: before,
    notes,
    requestId: (crypto.randomUUID ? crypto.randomUUID() : String(Date.now()) + "-" + Math.random().toString(16).slice(2))
  };

  try{
    await fetch(SCRIPT_URL, {
      method:"POST",
      headers:{ "Content-Type": "text/plain;charset=utf-8" },
      body: JSON.stringify({ action:"addAptRequest", data })
    });
  }catch(e){}

  const msg =
`APT INVITE REQUEST
Name: ${name}
Phone: ${phone}
Instagram: ${ig || "-"}
Been to APT before: ${before}
Notes: ${notes || "-"}`;

  const url = `https://wa.me/255768464367?text=${encodeURIComponent(msg)}`;

  sessionStorage.setItem("apt_last_status","submitted");
  sessionStorage.setItem("apt_last_ts", String(Date.now()));
  sessionStorage.setItem("apt_last_wa", url);

  showAptModal();

  setTimeout(() => {
    window.location.href = url;
  }, 650);
});


  
    const modal = document.getElementById("aptModalBackdrop");
  const closeBtn = document.getElementById("aptModalClose");
  const doneBtn = document.getElementById("aptModalDone");
  const submitBtn = document.getElementById("aptSubmitBtn");

  function showAptModal(){
    if(modal){
      modal.classList.remove("hidden");
      modal.setAttribute("aria-hidden","false");
      document.body.style.overflow = "hidden";
    }
  }

  function closeAptModal(){
    if(modal){
      modal.classList.add("hidden");
      modal.setAttribute("aria-hidden","true");
      document.body.style.overflow = "";
    }
    if(submitBtn){
      submitBtn.classList.add("submitted");
      submitBtn.innerHTML = `<i class="fa-solid fa-circle-check"></i> Booking submitted`;
    }
    __submittingApt = false;
    sessionStorage.setItem("apt_last_status","done");
  }

  if(closeBtn) closeBtn.addEventListener("click", closeAptModal);
  if(doneBtn) doneBtn.addEventListener("click", closeAptModal);

  if(modal){
    modal.addEventListener("click", (e) => {
      if(e.target === modal) closeAptModal();
    });
  }

  document.addEventListener("keydown", (e) => {
    if(e.key === "Escape" && modal && !modal.classList.contains("hidden")){
      closeAptModal();
    }
  });

  function handleAptReturn(){
    const status = sessionStorage.getItem("apt_last_status");
    const ts = Number(sessionStorage.getItem("apt_last_ts") || "0");
    if(status === "submitted" && (Date.now() - ts < 10 * 60 * 1000)){
      showAptModal();
    }
  }
  window.addEventListener("pageshow", handleAptReturn);
  window.addEventListener("focus", handleAptReturn);
  document.addEventListener("visibilitychange", () => {
    if(!document.hidden) handleAptReturn();
  });


  
})();
</script>

<script>
/* =========================================================
   APPLE-STYLE DARK MODE (MATCH INDEX)
========================================================= */
(function() {
  const root = document.documentElement;
  const toggle = document.getElementById("themeToggle");
  const stored = localStorage.getItem("theme");

  function applyTheme(theme) {
    if (theme === "dark") root.setAttribute("data-theme","dark");
    else root.setAttribute("data-theme","light");
    if (toggle){
      toggle.setAttribute("aria-pressed", theme === "dark" ? "true" : "false");
      toggle.title = theme === "dark" ? "Switch to light mode" : "Switch to dark mode";
    }
  }

  if (stored) {
    applyTheme(stored);
  } else {
    const prefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
    applyTheme(prefersDark ? "dark" : "light");
  }

  if (toggle) {
    toggle.addEventListener("click", () => {
      const isDark = root.getAttribute("data-theme") === "dark";
      const next = isDark ? "light" : "dark";
      applyTheme(next);
      localStorage.setItem("theme", next);
    });
  }
})();
</script>
<div id="aptModalBackdrop" class="apt-modal-backdrop hidden" aria-hidden="true">
  <div class="apt-modal" role="dialog" aria-modal="true" aria-labelledby="aptModalTitle">
    <div class="apt-modal-head">
      <div>
        <div id="aptModalTitle" class="apt-modal-title">Thank you for your time!</div>
        <div class="apt-modal-sub">Your APT request has been submitted.</div>
      </div>
      <button class="apt-modal-x" id="aptModalClose" type="button" aria-label="Close">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>

    <div class="apt-modal-body">
      <div class="apt-modal-row">
        <div class="k">What’s next?</div>
                <div class="v">We’ll reach out on WhatsApp or Instagram if a slot opens.</div>
      </div>

      <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap;">
        <button class="btn" id="aptModalDone" type="button">Done</button>
      </div>
    </div>
  </div>
</div>

</body>
</html>
